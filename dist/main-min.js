var gulp=require("gulp");gulp.paths={src:"www",js:["gulpfile.js","gulp/**/*","www/*.js","www/**/*.js"],html:["www/*.html","www/**/*.html"]},require("require-dir")("./gulp");var gulp=require("gulp"),paths=gulp.paths,prettify=require("gulp-jsbeautifier");gulp.task("beautify-html",function(){gulp.src(paths.html,{base:"."}).pipe(prettify({config:".jsbeautifyrc"})).pipe(gulp.dest("."))}),gulp.task("beautify",function(){gulp.src(paths.js,{base:"."}).pipe(prettify({config:".jsbeautifyrc",mode:"VERIFY_AND_WRITE"})).pipe(gulp.dest("."))});var gulp=require("gulp"),paths=gulp.paths,$=require("gulp-load-plugins")({pattern:["gulp-*","main-bower-files","uglify-save-license","del"]});gulp.task("partials",function(){});var gulp=require("gulp"),concat=require("gulp-concat"),paths=gulp.paths,minify=require("gulp-minify");gulp.task("concat-compress",function(){return gulp.src(paths.js).pipe(concat("main.js")).pipe(minify({ext:{min:"-min.js"},exclude:["tasks"],ignoreFiles:["-min.js"]})).pipe(gulp.dest("./dist/"))}),gulp.task("default",["concat-compress"]),function(){"use strict";angular.module("keyMS",["keys-module","popup-module","keyMS.index-controller","keyMS.common-service","720kb.datepicker","validation.match","keyMS.router"])}()(function(){"use strict";angular.module("keyMS.index-controller",[]).controller("indexController",function(e,a){var t=this;t.keyMSService=a,t.openPopup=function(e){t.keyMSService.setPopupData(),t.keyMSService.isSecondaryEdit=!1,t.keyMSService.isEdit=!1},t.openMenu=function(){t.keyMSService.isMenuOpen=!0},t.closeMenu=function(){t.keyMSService.isMenuOpen=!1},t.openAccordion=function(){angular.element(".menu-lists").slideToggle(),angular.element(".menu-heading").toggleClass("up-arrow")}})})()(function(){"use strict";angular.module("keyMS.router",["ngRoute"]).config(function(e){e.when("/",{template:'<div class="key-title"><div class="logo-key">P</div><p>Primary Key</p><div class="add-btn" ng-if="!indexCtrl.keyMSService.isSecondary" ng-click="indexCtrl.openPopup()">Add+</div></div> <keys class="table-container"></keys>'}).when("/primarykey/:ID",{template:'<div class="key-title"><div class="logo-key">P</div><p>Primary Key</p><div class="add-btn" ng-click="indexCtrl.openPopup()">Add+</div><p class="count">No. of Primary keys added - {{indexCtrl.keyMSService.count}}</p></div> <keys table-heading="popupCtrl.heading" isSecondary="false" class="table-container"></keys>',controller:"popupController",controllerAs:"popupCtrl"}).when("/secondarykey/:ID",{template:'<div class="key-title"><div class="logo-key">S</div><p>Secondary Key</p><div class="add-btn" ng-click="indexCtrl.openPopup()">Add+</div></div> <keys table-heading="popupCtrl.heading" class="table-container"></keys>',controller:"popupController",controllerAs:"popupCtrl"})})})()(function(){"use strict";angular.module("keyMS.common-service",["ngStorage"]).service("keyMSService",function(e){var a={};return a.userData=[],a.isPopUpVisible=!1,a.isPassPopup=!1,a.index="",a.isEdit=!1,a.count=0,a.isSecondary=!1,a.isSecondaryEdit=!1,a.parentIndex="",a.isSecondaryDelete=!1,a.isMenuOpen=!1,a.getUserData=function(){return e.userData&&(a.userData=e.userData,a.count=e.userData.length),a.userData},a.setUserData=function(t){t.key=a.createRandomKey(),a.isEdit?(a.userData[a.index].description=t.description,a.userData[a.index].activeon=t.activeon,a.userData[a.index].color=t.color,a.userData[a.index].expiry=t.expiry,e.userData=a.userData):t.primaryKey||(a.userData.push(t),e.userData=a.userData),a.count=a.userData.length,t.primaryKey&&!a.isSecondaryEdit&&angular.forEach(a.userData,function(r,i){if(r.key===t.primaryKey){var s={key:t.key,description:t.description,activeon:t.activeon,color:t.color,expiry:t.expiry,password:t.password};a.userData[i].secondaryKey||(a.userData[i].secondaryKey=[]),a.userData[i].secondaryKey.push(s),e.userData=a.userData}}),a.isSecondaryEdit&&(a.userData[a.parentIndex].secondaryKey[a.index].description=t.description,e.userData=a.userData),e.userData.length||(e.userData=a.userData)},a.getPopupData=function(){return a.isPopUpVisible},a.setPopupData=function(e){"passPopup"===e&&(a.isPassPopup=!0),a.isPopUpVisible=!0},a.createRandomKey=function(){for(var e="",a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=0;t<9;t++)e+=a.charAt(Math.floor(Math.random()*a.length));return e},a})})()(function(){"use strict";angular.module("keys-module-directive",[]).component("keys",{bindings:{tableHeading:"="},controller:"popupController",controllerAs:"keysCtrl",templateUrl:"components/keys/keys.html"})})()(function(){"use strict";angular.module("keys-module",["keys-module-directive"])})()(function(){"use strict";angular.module("keyMS.popup-controller",["ngTable","ngStorage"]).controller("popupController",function(e,a,t,r,i){var s=this;s.newUserData={},s.keyMSService=a,s.isSecondary=parseInt(i.ID),s.keyMSService.isSecondary=s.isSecondary,s.heading=["Key","Description","Active On","Expires On","Actions"],s.isSecondary&&(s.heading[0]="Secondary Key"),console.log(s.tableHeading),s.submitForm=function(){a.setUserData(s.newUserData),s.checkKeyStatus(s.newUserData),s.closeModal()},s.tableData=s.keyMSService.getUserData(),e.tableData=s.tableData,s.tableParams=new t({page:1,count:4},{total:0,dataset:s.tableData}),e.$watch("tableData",function(){s.tableParams.settings().$scope=e,s.tableParams.reload()},!0),s.closeModal=function(){a.isPopUpVisible=!1,a.isPassPopup=!1},s.checkKeyStatus=function(e){var a=e.activeon,t=e.expiry;s.newUserData.color=s.compareDates(t,a),s.keyMSService.isEdit&&(s.tableData[s.keyMSService.index].color=s.newUserData.color,s.keyMSService.isEdit=!1)},s.compareDates=function(e,a){var t=new Date,r=t.getDate(),i=t.getMonth()+1,s=t.getFullYear();r<10&&(r="0"+r),i<10&&(i="0"+i);var n=s+"/"+i+"/"+r,t=new Date(n).getTime()/1e3,o=new Date(e).getTime()/1e3,c=new Date(a).getTime()/1e3;return t>c&&t<o?"rgb(43, 255, 18)":t<c&&t<o?"rgb(234, 249, 0)":t>o&&t>c?"rgb(255, 66, 66)":t===c&&t<o?"rgb(43, 255, 18)":t===c&&t===o?"rgb(43, 255, 18)":t>c&&t===o?"rgb(43, 255, 18)":void 0},s.submitPassForm=function(){var e=s.keyMSService.index,a=s.keyMSService.parentIndex;s.keyMSService.isEdit===!0&&(s.passwordPop===s.tableData[e].password?(s.title="Edit Key",s.keyMSService.isPassPopup=!1,s.keyMSService.setPopupData(),s.newUserData.description=s.tableData[e].description,s.newUserData.activeon=s.tableData[e].activeon,s.newUserData.expiry=s.tableData[e].expiry):s.passwordIncorrect=!0),s.keyMSService.isDelete===!0&&(s.passwordPop===s.tableData[e].password?(s.tableData.splice(e,1),s.keyMSService.isPassPopup=!1,s.keyMSService.isPopUpVisible=!1,s.passwordIncorrect=!1):s.passwordIncorrect=!0),s.keyMSService.isSecondaryEdit===!0&&(s.passwordPop===s.tableData[a].secondaryKey[e].password?(s.title="Edit secondary Key",s.keyMSService.isPassPopup=!1,s.keyMSService.setPopupData(),s.newUserData.key=s.tableData[a].secondaryKey[e].key,s.newUserData.description=s.tableData[a].secondaryKey[e].description,s.newUserData.activeon=s.tableData[a].secondaryKey[e].activeon,s.newUserData.expiry=s.tableData[a].secondaryKey[e].expiry,s.newUserData.primaryKey=s.tableData[a].key):s.passwordIncorrect=!0),s.keyMSService.isSecondaryDelete===!0&&(s.passwordPop===s.tableData[a].secondaryKey[e].password?(s.tableData[a].secondaryKey.splice(e,1),s.keyMSService.isPassPopup=!1,s.keyMSService.isPopUpVisible=!1,s.passwordIncorrect=!1):s.passwordIncorrect=!0)},s.deleteRow=function(e,a){s.keyMSService.setPopupData("passPopup"),s.keyMSService.isEdit=!1,s.keyMSService.isDelete=!0,s.keyMSService.isSecondaryEdit=!1,s.keyMSService.isSecondaryDelete=!1,e>=0&&""!==e?(s.keyMSService.parentIndex=e,s.keyMSService.isSecondaryEdit=!1,s.keyMSService.isSecondaryDelete=!0,s.keyMSService.isEdit=!1,s.keyMSService.isDelete=!1,angular.forEach(s.tableData[e].secondaryKey,function(e,t){a===e.key&&(s.keyMSService.index=t)})):angular.forEach(s.tableData,function(e,t){a===e.key&&(s.keyMSService.index=t)})},s.editKey=function(e,a){s.keyMSService.setPopupData("passPopup"),s.keyMSService.isEdit=!0,s.keyMSService.isDelete=!1,s.keyMSService.isSecondaryEdit=!1,s.keyMSService.isSecondaryDelete=!1,e>=0&&""!==e?(s.keyMSService.parentIndex=e,s.keyMSService.isSecondaryEdit=!0,s.keyMSService.isEdit=!1,s.keyMSService.isDelete=!1,s.keyMSService.isSecondaryDelete=!1,angular.forEach(s.tableData[e].secondaryKey,function(e,t){a===e.key&&(s.keyMSService.index=t)})):angular.forEach(s.tableData,function(e,t){a===e.key&&(s.keyMSService.index=t)})},s.poulateData=function(e){angular.forEach(a.userData,function(a,t){e===a.key&&(s.newUserData.description=a.description,s.newUserData.activeon=a.activeon,s.newUserData.expiry=a.expiry)})}})})()(function(){"use strict";angular.module("popup-module-directive",[]).component("popup",{bindings:{title:"@"},controller:"popupController",controllerAs:"popupCtrl",templateUrl:"components/popup/popup.html"})})()(function(){"use strict";angular.module("popup-module",["keyMS.popup-controller","popup-module-directive"])})();